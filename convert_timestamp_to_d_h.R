ceiling_fan_model <- lm(out.electricity.ceiling_fan.energy_consumption~in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.city+in.clothes_dryer+in.clothes_washer+in.cooking_range+in.cooling_setpoint+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county+in.county_and_puma+in.ducts+in.federal_poverty_level+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_stories+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_fuel+in.heating_setpoint+in.heating_setpoint_offset_magnitude+in.heating_setpoint_offset_period+in.hvac_cooling_efficiency+in.hvac_cooling_type+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type+in.hvac_heating_type_and_fuel+in.income+in.income_recs_2015+in.income_recs_2020+in.insulation_ceiling+in.insulation_floor+in.insulation_foundation_wall+in.insulation_rim_joist+in.insulation_roof+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_gas_fireplace+in.misc_gas_grill+in.misc_gas_lighting+in.misc_hot_tub_spa+in.misc_pool+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.pv_orientation+in.range_spot_vent_hour+in.reeds_balancing_area+in.refrigerator+in.roof_material+in.tenure+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.cooking_range, data=reduced_data)
clothes_dryer_model <- lm(out.electricity.clothes_dryer.energy_consumption~in.clothes_dryer+in.clothes_washer+in.federal_poverty_level+in.hvac_has_zonal_electric_heating+in.insulation_rim_joist+in.occupants+in.reeds_balancing_area+in.usage_level+in.vacancy_status+upgrade.water_heater_efficiency+upgrade.clothes_dryer, data=reduced_data)
clothes_washer_model <- lm(out.electricity.clothes_washer.energy_consumption~in.federal_poverty_level+in.occupants+in.usage_level+in.vacancy_status+upgrade.water_heater_efficiency+upgrade.clothes_dryer, data=reduced_data)
cooling_fans_pumps <- lm(out.electricity.cooling_fans_pumps.energy_consumption~in.building_america_climate_zone+in.ceiling_fan+in.city+in.clothes_dryer+in.clothes_washer+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county_and_puma+in.ducts+in.federal_poverty_level+in.geometry_attic_type+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_fuel+in.heating_setpoint+in.heating_setpoint_offset_period+in.hot_water_fixtures+in.hvac_cooling_partial_space_conditioning+in.hvac_has_ducts+in.hvac_heating_efficiency+in.hvac_heating_type_and_fuel+in.income+in.income_recs_2015+in.income_recs_2020+in.infiltration+in.insulation_ceiling+in.insulation_floor+in.insulation_foundation_wall+in.insulation_rim_joist+in.insulation_slab+in.insulation_wall+in.misc_extra_refrigerator+in.misc_freezer+in.misc_gas_grill+in.misc_hot_tub_spa+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.pv_orientation+in.reeds_balancing_area+in.roof_material+in.tenure+in.usage_level+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.insulation_roof+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.insulation_foundation_wall, data=reduced_data)
cooling_model<-lm(out.electricity.cooling.energy_consumption~in.bedrooms+in.building_america_climate_zone+in.cooking_range+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county_and_puma+in.ducts+in.federal_poverty_level+in.geometry_attic_type+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_stories+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_fuel+in.heating_setpoint+in.heating_setpoint_offset_period+in.hot_water_fixtures+in.hvac_cooling_partial_space_conditioning+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type_and_fuel+in.income+in.income_recs_2015+in.infiltration+in.insulation_ceiling+in.insulation_floor+in.insulation_foundation_wall+in.insulation_rim_joist+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_extra_refrigerator+in.misc_freezer+in.misc_gas_grill+in.misc_gas_lighting+in.misc_hot_tub_spa+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.pv_orientation+in.pv_system_size+in.reeds_balancing_area+in.roof_material+in.usage_level+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.insulation_roof+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.insulation_foundation_wall, data=reduced_data)
dishwasher_model <- lm(out.electricity.dishwasher.energy_consumption~in.ducts+in.federal_poverty_level+in.geometry_foundation_type+in.geometry_wall_exterior_finish+in.has_pv+in.hvac_cooling_efficiency+in.hvac_cooling_type+in.hvac_has_ducts+in.income_recs_2015+in.income_recs_2020+in.insulation_slab+in.misc_gas_grill+in.misc_gas_lighting+in.misc_pool_heater+in.occupants+in.pv_system_size+in.usage_level+in.vacancy_status+upgrade.infiltration_reduction+upgrade.insulation_wall, data=reduced_data)
freezer_model <- lm(out.electricity.freezer.energy_consumption~in.misc_freezer, data=reduced_data)
heating_fans_pumps_model <- lm(out.electricity.heating_fans_pumps.energy_consumption~in.bathroom_spot_vent_hour+in.building_america_climate_zone+in.ceiling_fan+in.city+in.clothes_dryer+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.dishwasher+in.ducts+in.federal_poverty_level+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_setpoint+in.heating_setpoint_offset_magnitude+in.heating_setpoint_offset_period+in.hvac_cooling_partial_space_conditioning+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_type+in.income+in.income_recs_2015+in.income_recs_2020+in.infiltration+in.insulation_floor+in.insulation_foundation_wall+in.insulation_rim_joist+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_freezer+in.misc_gas_fireplace+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.orientation+in.puma_metro_status+in.range_spot_vent_hour+in.reeds_balancing_area+in.refrigerator+in.roof_material+in.tenure+in.usage_level+in.vacancy_status+in.vintage_acs+in.weather_file_city+in.weather_file_latitude+in.window_areas+in.windows+upgrade.infiltration_reduction+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.ducts+upgrade.insulation_foundation_wall, data=reduced_data)
heating_model  <- lm(out.electricity.heating.energy_consumption~in.bathroom_spot_vent_hour+in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.city+in.clothes_dryer+in.clothes_washer+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.ducts+in.federal_poverty_level+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_setpoint+in.heating_setpoint_offset_magnitude+in.hvac_cooling_partial_space_conditioning+in.hvac_cooling_type+in.hvac_has_zonal_electric_heating+in.hvac_heating_type+in.income+in.income_recs_2015+in.income_recs_2020+in.infiltration+in.insulation_floor+in.insulation_foundation_wall+in.insulation_rim_joist+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_extra_refrigerator+in.misc_freezer+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.orientation+in.puma_metro_status+in.reeds_balancing_area+in.refrigerator+in.roof_material+in.usage_level+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.infiltration_reduction+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_foundation_wall, data=reduced_data)
hot_tub_heater_model <- lm(out.electricity.hot_tub_heater.energy_consumption~in.bathroom_spot_vent_hour+in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.clothes_dryer+in.clothes_washer+in.cooking_range+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county+in.county_and_puma+in.dishwasher+in.ducts+in.federal_poverty_level+in.geometry_attic_type+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.heating_fuel+in.heating_setpoint_offset_magnitude+in.hot_water_fixtures+in.hvac_cooling_efficiency+in.hvac_cooling_partial_space_conditioning+in.hvac_cooling_type+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type+in.income+in.infiltration+in.insulation_floor+in.insulation_rim_joist+in.insulation_roof+in.insulation_wall+in.lighting+in.misc_extra_refrigerator+in.misc_freezer+in.misc_gas_fireplace+in.misc_gas_grill+in.misc_hot_tub_spa+in.misc_pool+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.pv_system_size+in.range_spot_vent_hour+in.reeds_balancing_area+in.roof_material+in.tenure+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.insulation_roof+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.insulation_foundation_wall, data=reduced_data)
hot_tub_pump_model <- lm(out.electricity.hot_tub_pump.energy_consumption~in.bathroom_spot_vent_hour+in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.clothes_dryer+in.clothes_washer+in.cooking_range+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county+in.county_and_puma+in.dishwasher+in.ducts+in.federal_poverty_level+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_stories+in.geometry_wall_type+in.has_pv+in.heating_fuel+in.heating_setpoint+in.heating_setpoint_offset_magnitude+in.heating_setpoint_offset_period+in.hvac_cooling_efficiency+in.hvac_cooling_partial_space_conditioning+in.hvac_cooling_type+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type+in.hvac_heating_type_and_fuel+in.income+in.income_recs_2015+in.income_recs_2020+in.infiltration+in.insulation_floor+in.insulation_rim_joist+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_extra_refrigerator+in.misc_freezer+in.misc_gas_fireplace+in.misc_gas_grill+in.misc_gas_lighting+in.misc_hot_tub_spa+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.range_spot_vent_hour+in.reeds_balancing_area+in.refrigerator+in.roof_material+in.tenure+in.vintage+in.vintage_acs+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+in.windows+upgrade.water_heater_efficiency+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.insulation_wall+upgrade.insulation_foundation_wall+upgrade.cooking_range, data=reduced_data)
hot_water_model <- lm(out.electricity.hot_water.energy_consumption~in.bathroom_spot_vent_hour+in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.clothes_washer+in.cooking_range+in.cooling_setpoint+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county+in.county_and_puma+in.dishwasher+in.ducts+in.federal_poverty_level+in.geometry_attic_type+in.geometry_floor_area+in.geometry_stories+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_setpoint+in.heating_setpoint_offset_magnitude+in.hot_water_fixtures+in.hvac_cooling_efficiency+in.hvac_cooling_partial_space_conditioning+in.hvac_cooling_type+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type+in.hvac_heating_type_and_fuel+in.insulation_foundation_wall+in.insulation_roof+in.insulation_wall+in.misc_freezer+in.misc_gas_fireplace+in.misc_gas_lighting+in.misc_hot_tub_spa+in.misc_pool_heater+in.misc_well_pump+in.occupants+in.puma+in.puma_metro_status+in.pv_orientation+in.pv_system_size+in.range_spot_vent_hour+in.reeds_balancing_area+in.usage_level+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+upgrade.insulation_roof+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.insulation_foundation_wall+upgrade.cooking_range, data=reduced_data)
lighting_exterior_model <- lm(out.electricity.lighting_exterior.energy_consumption~in.bedrooms+in.building_america_climate_zone+in.ceiling_fan+in.city+in.clothes_dryer+in.clothes_washer+in.cooking_range+in.cooling_setpoint+in.cooling_setpoint_has_offset+in.cooling_setpoint_offset_magnitude+in.cooling_setpoint_offset_period+in.county+in.county_and_puma+in.dishwasher+in.ducts+in.federal_poverty_level+in.geometry_attic_type+in.geometry_floor_area+in.geometry_floor_area_bin+in.geometry_foundation_type+in.geometry_garage+in.geometry_stories+in.geometry_wall_exterior_finish+in.geometry_wall_type+in.has_pv+in.heating_fuel+in.heating_setpoint+in.heating_setpoint_offset_period+in.hot_water_fixtures+in.hvac_cooling_efficiency+in.hvac_cooling_partial_space_conditioning+in.hvac_cooling_type+in.hvac_has_ducts+in.hvac_has_zonal_electric_heating+in.hvac_heating_efficiency+in.hvac_heating_type_and_fuel+in.income+in.income_recs_2015+in.infiltration+in.insulation_ceiling+in.insulation_floor+in.insulation_rim_joist+in.insulation_roof+in.insulation_slab+in.insulation_wall+in.lighting+in.misc_extra_refrigerator+in.misc_freezer+in.misc_gas_fireplace+in.misc_gas_grill+in.misc_gas_lighting+in.misc_hot_tub_spa+in.misc_pool+in.misc_well_pump+in.occupants+in.orientation+in.puma+in.puma_metro_status+in.pv_orientation+in.pv_system_size+in.refrigerator+in.roof_material+in.tenure+in.usage_level+in.vacancy_status+in.vintage+in.vintage_acs+in.water_heater_efficiency+in.water_heater_fuel+in.weather_file_city+in.weather_file_latitude+in.weather_file_longitude+in.window_areas+upgrade.insulation_roof+upgrade.water_heater_efficiency+upgrade.infiltration_reduction+upgrade.geometry_foundation_type+upgrade.clothes_dryer+upgrade.insulation_ceiling+upgrade.ducts+upgrade.insulation_wall+upgrade.insulation_foundation_wall+upgrade.cooking_range, data=reduced_data)

library("data.table")    

time_col <- fread("C:\\Users\\ybard\\Downloads\\IDS_data.csv", 
                  select = c("time"))
str(time_col)
reduced_data$hour <- str(as.numeric(format(time_col, format="%H")))
reduced_data$date <- as.numeric(format(time_col, format="%d"))
write.csv(reduced_data, "C:\\Users\\ybard\\Downloads\\reduced_data.csv", row.names=FALSE)

reduced_data <- read.csv("C:\\Users\\ybard\\Downloads\\final_data.csv")

class(reduced_data$date)
memory.limit(25000)